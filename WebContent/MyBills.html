<!DOCTYPE html>
<html>
<head>
<title>我的订单</title>
<link href="css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/scripts.js"></script>
<link href="css/styles.css" rel="stylesheet">
<link href="css/style.css" rel="stylesheet" type="text/css" media="all" />	
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
</head>
<body>
<!-- 模态框2 -->
<div class="modal fade" id="CancelModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel"><b>退订</b></h4>
            </div>
            <div class="modal-body">
            	酒店退订！！
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" id="Cancel">退订</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>
<!-- 模态框2 -->

<!--header-->
	<div class="navigation">
			<div class="container-fluid">
				<nav class="pull">
					<ul>
						<li><a  href="/HostelWorld/home?id=0">主页</a></li>
						<li><a  href="about.html">关于我们</a></li>
						<li><a  href="/HostelWorld/home?id=5">个人页面</a></li>
					</ul>
				</nav>			
			</div>
		</div>

<div class="header">
	<div class="container">
		<!--logo-->
			<div class="logo">
				<h1><a href="index.html">客栈之家</a></h1>
			</div>
		<!--//logo-->
		<div class="top-nav">
			<ul class="right-icons">
				<li><a  href="http://localhost:8080/HostelWorld/logout"><i class="glyphicon glyphicon-user"> </i>注销</a></li>
				<li><a class="play-icon popup-with-zoom-anim" href="#small-dialog"><i class="glyphicon glyphicon-search"> </i> </a></li>
				
			</ul>
			<div class="nav-icon">
				<div class="hero fa-navicon fa-2x nav_slide_button" id="hero">
						<a href="#"><i class="glyphicon glyphicon-menu-hamburger"></i> </a>
					</div>	
				<!---
				<a href="#" class="right_bt" id="activator"><i class="glyphicon glyphicon-menu-hamburger"></i>  </a>
			--->
			</div>
		<div class="clearfix"> </div>
			<!---pop-up-box---->
				    
				<link href="css/popuo-box.css" rel="stylesheet" type="text/css" media="all"/>
				<script src="js/jquery.magnific-popup.js" type="text/javascript"></script>
			<!---//pop-up-box---->
				<div id="small-dialog" class="mfp-hide">
					    <!----- tabs-box ---->
				<div class="sap_tabs">	
				     <div id="horizontalTab" style="display: block; width: 100%; margin: 0px;">
						  <ul class="resp-tabs-list">
						  	  <li class="resp-tab-item " aria-controls="tab_item-0" role="tab"><span>All Homes</span></li>
							  <li class="resp-tab-item" aria-controls="tab_item-1" role="tab"><span>For Sale</span></li>
							  <li class="resp-tab-item" aria-controls="tab_item-2" role="tab"><span>For Rent</span></li>
							  <div class="clearfix"></div>
						  </ul>				  	 
						  <div class="resp-tabs-container">
						  		<h2 class="resp-accordion resp-tab-active" role="tab" aria-controls="tab_item-0"><span class="resp-arrow"></span>All Homes</h2><div class="tab-1 resp-tab-content resp-tab-content-active" aria-labelledby="tab_item-0" style="display:block">
								 	<div class="facts">
									  	<div class="login">
											<input type="text" value="Search Address, Neighborhood, City or Zip" onfocus="this.value = '';" onblur="if (this.value == '') {this.value = 'Search Address, Neighborhood, City or Zip';}">		
									 		<input type="submit" value="">
									 	</div>        
							        </div>
						  		</div>
							     <h2 class="resp-accordion" role="tab" aria-controls="tab_item-1"><span class="resp-arrow"></span>For Sale</h2><div class="tab-1 resp-tab-content" aria-labelledby="tab_item-1">
									<div class="facts">									
										<div class="login">
											<input type="text" value="Search Address, Neighborhood, City or Zip" onfocus="this.value = '';" onblur="if (this.value == '') {this.value = 'Search Address, Neighborhood, City or Zip';}">		
									 		<input type="submit" value="">
									 	</div> 
							        </div>	
								 </div>									
							      <h2 class="resp-accordion" role="tab" aria-controls="tab_item-2"><span class="resp-arrow"></span>For Rent</h2><div class="tab-1 resp-tab-content" aria-labelledby="tab_item-2">
									 <div class="facts">
										<div class="login">
											<input type="text" value="Search Address, Neighborhood, City or Zip" onfocus="this.value = '';" onblur="if (this.value == '') {this.value = 'Search Address, Neighborhood, City or Zip';}">		
									 		<input type="submit" value="">
									 	</div> 
							         </div>	
							    </div>
					      </div>
					 </div>
					 <script src="js/easyResponsiveTabs.js" type="text/javascript"></script>
				    	<script type="text/javascript">
						    $(document).ready(function () {
						        $('#horizontalTab').easyResponsiveTabs({
						            type: 'default', //Types: default, vertical, accordion           
						            width: 'auto', //auto or any width like 600px
						            fit: true   // 100% fit in a container
						        });
						    });
			  			 </script>	
				</div>
				</div>
				 <script>
						$(document).ready(function() {
						$('.popup-with-zoom-anim').magnificPopup({
							type: 'inline',
							fixedContentPos: false,
							fixedBgPos: true,
							overflowY: 'auto',
							closeBtnInside: true,
							preloader: false,
							midClick: true,
							removalDelay: 300,
							mainClass: 'my-mfp-zoom-in'
						});
																						
						});
				</script>
					
	
		</div>
		<div class="clearfix"> </div>
		</div>	
</div>
<!--//-->	
<div class=" banner-buying">
	<div class=" container">
	<h3><span>订单</span></h3> 
	<!---->
	<div class="menu-right">
		 <ul class="menu">
			<li class="item1"><a href="#"> <span style="margin-right:10px;"></span>选项<i class="glyphicon glyphicon-menu-down"> </i> </a>
			<ul class="cute">
				<li class="subitem1"><a href="/HostelWorld/home?id=13">预订酒店 </a></li>
				<li class="subitem2"><a href="/HostelWorld/home?id=14">我的订单 </a></li>
				<li class="subitem3"><a href="/HostelWorld/home?id=3">我的会员卡</a></li>
			</ul>
		</li>
		</ul>
	</div>
	<div class="clearfix"> </div>
		<!--initiate accordion-->
		<script type="text/javascript">
			$(function() {
			    var menu_ul = $('.menu > li > ul'),
			           menu_a  = $('.menu > li > a');
			    menu_ul.hide();
			    menu_a.click(function(e) {
			        e.preventDefault();
			        if(!$(this).hasClass('active')) {
			            menu_a.removeClass('active');
			            menu_ul.filter(':visible').slideUp('normal');
			            $(this).addClass('active').next().stop(true,true).slideDown('normal');
			        } else {
			            $(this).removeClass('active');
			            $(this).next().stop(true,true).slideUp('normal');
			        }
			    });
			
			});
		</script>
      		
	</div>
</div>
<!--//header-->
<!--contact-->
<div class="contact">
	<div class="container" >
		<h3>预订订单</h3>
	 	<div class="list-group" id="Billslist"></div>
	 	<h3>历史订单</h3>
	 	<div class="list-group" id="historylist"></div>
	</div>
</div>
<!--//contact-->
<!--footer-->
<div class="footer">
	<div class="container">
		<div class="footer-top-at">
			<div class="col-md-3 amet-sed">
				<h4>Our Company</h4>
				<ul class="nav-bottom">
					<li><a href="about.html">About Us</a></li>
					<li><a href="blog.html">For Sale By Owner Blog</a></li>
					<li><a href="mobile_app.html">Mobile</a></li>
					<li><a href="terms.html">Terms & Conditions</a></li>
					<li><a href="privacy.html">Privacy Policy</a></li>	
					<li><a href="blog.html">Blog</a></li>
					
				</ul>	
			</div>
			<div class="col-md-3 amet-sed ">
				<h4>Work With Us</h4>
					<ul class="nav-bottom">
						<li><a href="single.html">Real Estate Brokers</a></li>
						<li><a href="single.html">Business Development</a></li>
						<li><a href="single.html">Affiliate Programs</a></li>
						<li><a href="contact.html">Sitemap</a></li>
						<li><a href="career.html">Careers</a></li>
						<li><a href="feedback.html">Feedback</a></li>	
					</ul>	
			</div>
			<div class="col-md-3 amet-sed">
				<h4>Customer Support</h4>
				<p>Mon-Fri, 7AM-7PM </p>
				<p>Sat-Sun, 8AM-5PM </p>
				<p>177-869-6559</p>
					<ul class="nav-bottom">
						<li><a href="#">Live Chat</a></li>
						<li><a href="faqs.html">Frequently Asked Questions</a></li>
						<li><a href="suggestion.html">Make a Suggestion</a></li>
					</ul>	
			</div>
			<div class="col-md-3 amet-sed ">
				<h4>Property Services</h4>
				   <ul class="nav-bottom">
						<li><a href="single.html">Residential Property</a></li>
						<li><a href="single.html">Commercial Property</a></li>
						<li><a href="login.html">Login</a></li>
						<li><a href="register.html">Register</a></li>
						<li><a href="typo.html">Short Codes</a></li>	
					</ul>	
					<ul class="social">
						<li><a href="#"><i> </i></a></li>
						<li><a href="#"><i class="gmail"> </i></a></li>
						<li><a href="#"><i class="twitter"> </i></a></li>
						<li><a href="#"><i class="camera"> </i></a></li>
						<li><a href="#"><i class="dribble"> </i></a></li>
					</ul>
			</div>
		<div class="clearfix"> </div>
		</div>
	</div>
</div>
<!--//footer-->

<script type="text/javascript">

var bookID = 0;

function getID(obj){
	bookID = obj.getAttribute("id");
	//alert(checkkkID);
}

$(document).ready(function () {


	
	$.ajax({
		url:"http://localhost:8080/HostelWorld/searchMyBook?sign=0",
		"type":"GET",
		"dataType":"json",
		"contentType": "application/json; charset=utf-8",
		"success": function(data){

			if(data=="fail"){
				document.getElementById('Billslist').innerHTML='<div class="alert alert-danger" role="alert" style="text-align: center"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>您暂时没有预订订单！<a href="http://localhost:8080/web/home.html"><strong>   返回首页   </strong></a></div>';
			}else{
				var temp = eval(data);
				var length = temp.length;

				for(var i=0;i<length;i++){
					var insertText = "<a href='#' onclick='getID(this)' class='list-group-item' id='"+temp[i].bookID+"' data-toggle='modal' data-target='#CancelModal'>"+
		 			"<h4 class='list-group-item-heading'>订单编号：<span>"+temp[i].bookID+"</span>"+
		 			"</h4>"+
		 			"<label>预订时间：<span>"+temp[i].bookTime+"</span></label>"+"<p></p>"+
		 			"<label'>酒店编号：<span>"+temp[i].hostelID+"</span></label>"+
		 			"<label' style='margin-left: 30px'>房间种类：<span>"+temp[i].category+"</span></label>"+
		 			"<label' style='margin-left: 30px'>总共消费：<span>"+temp[i].cost+"</span></label>"+"<p></p>"+
		 			"<label'>开始日期：<span>"+temp[i].startDate+"</span></label>"+
		 			"<label' style='margin-left: 30px'>结束日期：<span>"+temp[i].endDate+"</span></label>"+
		 		"</a>";
					document.getElementById('Billslist').innerHTML += insertText;
				}
			}
			//document.getElementById('loginChange').innerHTML = '注销';
			//$('#loginChange').attr('href','/HostelWorld/home?id=0');
		},
		"error":function(data){
			//window.location = "http://localhost:8080/GradeSearch/login.jsp";
			//document.getElementById('loginChange').innerHTML = '登录';
			//$('#loginChange').attr('href','/HostelWorld/home?id=1');
			
			document.getElementById('Billslist').innerHTML='<div class="alert alert-danger" role="alert" style="text-align: center"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>您暂时没有预订订单！<a href="http://localhost:8080/web/home.html"><strong>   返回首页   </strong></a></div>';
			
			//alert("Error");
		}
	});


	$.ajax({
		url:"http://localhost:8080/HostelWorld/searchMyBook?sign=1",
		"type":"GET",
		"dataType":"json",
		"contentType": "application/json; charset=utf-8",
		"success": function(data){

			if(data=="fail"){
				document.getElementById('historylist').innerHTML='<div class="alert alert-danger" role="alert" style="text-align: center"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>您暂时没有预订订单！<a href="http://localhost:8080/web/home.html"><strong>   返回首页   </strong></a></div>';
			}else{
				var temp = eval(data);
				var length = temp.length;

				for(var i=0;i<length;i++){
					var insertText = "<a href='#' class='list-group-item'>"+
		 			"<h4 class='list-group-item-heading'>订单编号：<span>"+temp[i].bookID+"</span>"+
		 			"</h4>"+
		 			"<label>预订时间：<span>"+temp[i].bookTime+"</span></label>"+"<p></p>"+
		 			"<label'>酒店编号：<span>"+temp[i].hostelID+"</span></label>"+
		 			"<label' style='margin-left: 30px; '>房间种类：<span>"+temp[i].category+"</span></label>"+
		 			"<label' style='margin-left: 30px'>总共消费：<span>"+temp[i].cost+"</span></label>"+"<p></p>"+
		 			"<label'>开始日期：<span>"+temp[i].startDate+"</span></label>"+
		 			"<label' style='margin-left: 25px'>结束日期：<span>"+temp[i].endDate+"</span></label>"+
		 		"</a>";
					document.getElementById('historylist').innerHTML += insertText;
				}
			}
			//document.getElementById('loginChange').innerHTML = '注销';
			//$('#loginChange').attr('href','/HostelWorld/home?id=0');
		},
		"error":function(data){
			//window.location = "http://localhost:8080/GradeSearch/login.jsp";
			//document.getElementById('loginChange').innerHTML = '登录';
			//$('#loginChange').attr('href','/HostelWorld/home?id=1');
			
			document.getElementById('historylist').innerHTML='<div class="alert alert-danger" role="alert" style="text-align: center"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>您暂时没有历史订单！！<a href="http://localhost:8080/web/home.html"><strong>   返回首页   </strong></a></div>';
			
			//alert("Error");
		}
	});
});

$('#Cancel').click(function(){
	//alert($('#account').val());
    $.ajax({
        url:"http://localhost:8080/HostelWorld/cancelBook",
        data:{"bookID":bookID},
        type:"get",
        success:function (data){
        	if(data=="success"){
	        	alert("退订成功");
	        }
        	setTimeout('toSearch()',1000);
        }
    });
});
function toSearch(){
    window.location.href="/HostelWorld/home?id=14";
}

</script>
</body>
</html>